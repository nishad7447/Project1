<%- include('../layout/userHeader')%>

<div class="hero-wrap hero-bread" style="background-image: url('/assets/images/bg_6.jpg');">
	<div class="container">
		<div class="row no-gutters slider-text align-items-center justify-content-center">
			<div class="col-md-9 ftco-animate text-center">
				<p class="breadcrumbs"><span class="mr-2"><a href="/">Home</a></span> <span><a
							href="/product">&nbsp;Products </a></span></p>
				<h1 class="mb-0 bread">Product Detailed</h1>
			</div>
		</div>
	</div>
</div>

	<% productData.forEach(function(productData) { %>
		<section class="ftco-section">
			<div class="container">
				<div class="row">
					<div class="col-lg-6 mb-5 ftco-animate">
						<div class="product-slider">
							<div class="product-img">
								<figure>
									<a href="<%= productData.images[0] %>" class="image-popup" style="display: flex; justify-content: center;">
										<img src="<%= productData.images[0] %>" id="main_product_image"
											data-zoom-image='<%= productData.images[0] %>' class="img-fluid" style=" max-height: 400px;"
											alt="Colorlib Template">
									</a>
								</figure>
							</div>
						</div>
						<% if (productData.images.length>0) { %>
						<div style="width: 20vh; margin-left: -18px;" class="mt-4">
							<ul style="list-style-type: none; display: flex; flex-direction: row;" class="col-sm-12">
								<% for (var i=1; i < productData.images.length; i++) { %>
									<li >
									<a href="<%= productData.images[i] %>" class="image-popup" style="display: flex; justify-content: center;">
										<img src="<%= productData.images[i] %>" class="img-fluid mr-4" style="max-width: 250px; height: 150px;">
									</li>
									<% } %>
							</ul>
						</div>
                          <% } %>
					</div>
					<div class="col-lg-6 product-details pl-md-5 ftco-animate">
						<h3>
							<%= productData.name %>
						</h3>
						<div class="rating d-flex">
							<p class="text-left mr-4">
								<a href="#" class="mr-2">5.0</a>
								<a href="#"><span class="ion-ios-star-outline"></span></a>
								<a href="#"><span class="ion-ios-star-outline"></span></a>
								<a href="#"><span class="ion-ios-star-outline"></span></a>
								<a href="#"><span class="ion-ios-star-outline"></span></a>
								<a href="#"><span class="ion-ios-star-outline"></span></a>
							</p>
							<p class="text-left mr-4">
								<a href="#" class="mr-2" style="color: #000;">100 <span
										style="color: #bbb;">Rating</span></a>
							</p>
							<p class="text-left">
								<a href="#" class="mr-2" style="color: #000;">500 <span
										style="color: #bbb;">Sold</span></a>
							</p>
						</div>
						<p class="price"><span>
								<%= productData.price %>
							</span></p>
						<p>
							<%= productData.description %>
						</p>
						<div class="row mt-4">
							<div class="w-100"></div>
							<div class="input-group col-md-6 d-flex mb-3">
							</div>
							<div class="w-100"></div>
							<div class="col-md-12">
								<p style="color: #000;">
									<%= productData.stock%> piece available
								</p>
							</div>
						</div>
						<div class="d-flex ">
							<p>
								<% if (locals.user) { %>
									<a onclick="addToCart('<%= productData._id %>')" class="btn btn-black py-3 px-5 ">Add to
										Cart</a></p>
									 <% }else{ %>
										<a href="/login" class="btn btn-black py-3 px-5 ">Add to
											Cart</a></p>
										<% } %>
									<% if (locals.user) { %>
										&nbsp;&nbsp;<p><a onclick="addToWishlist('<%= productData._id %>')" class=" btn btn-light py-3 px-5 border border-dark">Add to
											Wishlist</a></p>
								  <% }else{ %>
									&nbsp;&nbsp;<p><a href="/login" class=" btn btn-light py-3 px-5 border border-dark">Add to
										Wishlist</a></p>
								  <% } %>
						</div>
					</div>
				</div>
			</div>
		</section>

		<section class="ftco-section bg-light">
			<div class="container">
				<div class="row justify-content-center mb-3 pb-3">
					<div class="col-md-12 heading-section text-center ftco-animate">
						<h2 class="mb-4">Ralated Products</h2>
					</div>
				</div>
			</div>
			<div class="container">
				<div class="row">
					<% if (relatedProducts.length>0) { %>
	<% relatedProducts.forEach(function(relatedPro) { %>
				<% if(relatedPro.stock<1) { %>
						<div class="col-sm-6 col-md-6 col-lg-4 ftco-animate">
							<div class="product" >
								<div class="product-img-wrapper out-of-stock">
									<a href="#">
									  <img src="<%= relatedPro.images[0] %>" style="max-width: 100%; height: 290px; margin: auto;" alt="<%= relatedPro.name %>">
									</a>
									  <div class="out-of-stock-overlay ">Out of Stock</div>
								  </div>
								<div class="text py-3 px-3">
									<h3><a href="#">
										<%= relatedPro.name %>
									</a></h3>
									<div class="d-flex">
										<div class="pricing">
											<p class="price"><span class="price-sale">₹<%= relatedPro.price %>
											</span></p>
										</div>
										<div class="rating">
											<p class="text-right">
												<a href="#"><span class="ion-ios-star-outline"></span></a>
												<a href="#"><span class="ion-ios-star-outline"></span></a>
												<a href="#"><span class="ion-ios-star-outline"></span></a>
												<a href="#"><span class="ion-ios-star-outline"></span></a>
												<a href="#"><span class="ion-ios-star-outline"></span></a>
											</p>
										</div>
									</div>
									<p class="bottom-area d-flex px-3">
													<% if (locals.user) { %>
														<a class="add-to-cart text-center py-2 mr-1"><span>Out of stock <i
															class="icon-shopping_cart ml-1"></i></span></a>
														 <% }else{ %>
															<a href="/login"  class="add-to-cart text-center py-2 mr-1"><span>Out of stock <i
																class="icon-shopping_cart ml-1"></i></span></a>
															<% } %>
														<% if (locals.user) { %>
														
													<a onclick="addToWishlist('<%= relatedPro._id %>')" class="buy-now text-center py-2"><span>To Wishlist<i
														class="icon-heart ml-1"></i></span></</a>
													  <% }else{ %>
														
													<a href="/login" class="buy-now text-center py-2"><span>To Wishlist<i
														class="icon-heart ml-1"></i></span></</a>
													  <% } %>
								</div>
							</div>
						</div>
					<% } else { %>
						<div class="col-sm-6 col-md-6 col-lg-4 ftco-animate">
							<div class="product" >
								<a href="/productDetail/<%= relatedPro._id %>" class="img-prod" style="max-height: 290px; text-align: center;">
									<img class="img-fluid" src="<%= relatedPro.images[0] %>" style="max-width: 100%; height: 290px; margin: auto;" alt="Colorlib Template">
								</a>
								<div class="text py-3 px-3">
									<h3><a href="/productDetail/<%= relatedPro._id %>">
										<%= relatedPro.name %>
									</a></h3>
									<div class="d-flex">
										<div class="pricing">
											<p class="price"><span class="price-sale">₹<%= relatedPro.price %>
											</span></p>
										</div>
										<div class="rating">
											<p class="text-right">
												<a href="#"><span class="ion-ios-star-outline"></span></a>
												<a href="#"><span class="ion-ios-star-outline"></span></a>
												<a href="#"><span class="ion-ios-star-outline"></span></a>
												<a href="#"><span class="ion-ios-star-outline"></span></a>
					
										<a href="#"><span class="ion-ios-star-outline"></span></a>
									</p>
								</div>
									</div>
									<p class="bottom-area d-flex px-3">
										<% if (locals.user) { %>
											<a onclick="addToCart('<%= relatedPro._id %>')" class="add-to-cart text-center py-2 mr-1"><span>Add to cart <i
												class="ion-ios-cart ml-1"></i></span></a>
											 <% }else{ %>
												<a href="/login" class="add-to-cart text-center py-2 mr-1"><span>Add to cart <i
													class="ion-ios-cart ml-1"></i></span></a>
												<% } %>
											<% if (locals.user) { %>
											
										<a onclick="addToWishlist('<%= relatedPro._id %>')" class="buy-now text-center py-2"><span>To Wishlist<i
											class="icon-heart ml-1"></i></span></</a>
										  <% }else{ %>
											
										<a href="/login" class="buy-now text-center py-2"><span>To Wishlist<i
											class="icon-heart ml-1"></i></span></</a>
										  <% } %></p>
								</div>
						</div>
					</div>
					<% } %>
					<% }) %>

					<% }else{ %>
						<div class="col-md-12  text-center ftco-animate">
							<p class="mb-4">No Related Products found</p>
						</div>
						<% } %>
				</div>
			</div>
		</section>


		<!-- loader -->
		<div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px">
				<circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
				<circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
					stroke="#F96D00" />
			</svg></div>


		<!-- {{!-- elevate zoom --}} -->
		<script>
			let main_prodcut_image = document.getElementById('main_product_image');
			$("#main_product_image").data('zoom-image', main_prodcut_image.src).elevateZoom({
				responsive: true,
				zoomWindowWidth: 300,
				zoomWindowHeight: 300,
				cursor: "crosshair"
			});
		</script>

		<script>
			function addToCart(productId) {
				axios.get(`/cart/${productId}`).then((response) => {
					if (response.status) {
						Toastify({
							text: `${response.data.message}`,
							duration: 3000,
							className: "info",
							gravity: "bottom", // `top` or `bottom`
							position: "center",
							style: {
								background: "linear-gradient(to right, #00b09b, #96c93d)",
							}
						}).showToast();
					}
				}).catch((err) => {
					Toastify({
						text: "product is not added to cart",
						duration: 3000,
						className: "info",
						gravity: "bottom", // `top` or `bottom`
						position: "center",
						style: {
							background: "linear-gradient(to right, #00b09b, #96c93d)",
						}
					}).showToast();
				})
			}
			function addToWishlist(productId){
			axios.get(`/wishlist/${productId}`).then((response)=>{
				if(response.status){
					Toastify({
						text: `${response.data.message}`,
						duration: 3000,
						className: "info",
						gravity: "bottom", // `top` or `bottom`
						position: "center",
						style: {
						  background: "linear-gradient(to right, #00b09b, #96c93d)",
						}
					}).showToast();
				}
			}).catch((err)=>{
				Toastify({
					text: "product is not added to Wishlist",
					duration: 3000,
					className: "info",
					gravity: "bottom", // `top` or `bottom`
					position: "center",
					style: {
					  background: "linear-gradient(to right, #00b09b, #96c93d)",
					}
				}).showToast();
			})
		}
		</script>

		<% }) %>
			<%- include('./about')%>
				<%- include('../layout/userFooter')%>